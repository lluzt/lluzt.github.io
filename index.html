<!DOCTYPE html>





<html class="theme-next mist use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="generator" content="Hexo 3.9.0">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.2.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.2.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.2.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.2.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.2.0',
    sidebar: {"position":"right","display":"post","offset":12,"onmobile":false},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    search: {
      root: '/',
      path: ''
    },
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    }
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="卢至彤">
<meta property="og:url" content="https://lluzt.github.io/index.html">
<meta property="og:site_name" content="卢至彤">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="卢至彤">
  <link rel="canonical" href="https://lluzt.github.io/">


<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>卢至彤</title>
  








  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  <div class="container sidebar-position-right page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">卢至彤</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
    <ul id="menu" class="menu">
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br/>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br/>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br/>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br/>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-reference">
      
    

    <a href="/reference/" rel="section"><i class="menu-item-icon fa fa-fw fa-simplybuilt"></i> <br/>reference</a>

  </li>
    </ul>
    

</nav>

</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lluzt.github.io/2019/08/29/Java-日志框架/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="卢至彤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="卢至彤">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/29/Java-日志框架/" class="post-title-link" itemprop="url">Java 日志框架</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-08-29 10:09:21" itemprop="dateCreated datePublished" datetime="2019-08-29T10:09:21+08:00">2019-08-29</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-08-30 16:33:47" itemprop="dateModified" datetime="2019-08-30T16:33:47+08:00">2019-08-30</time>
              </span>
            
          

          <br/>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <h1 id="Java-日志框架"><a href="#Java-日志框架" class="headerlink" title="Java 日志框架"></a>Java 日志框架</h1><p>Java应用日志收集都是采用日志框架(slf4j、apache commons logging)+日志系统（log4j、log4j2、LogBack、JUL等）的方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">日志框架：提供日志调用的接口，实际的日志输出托付给日志系统实现。</span><br><span class="line">    JCL(Jakarta Commons Logging)：也称为&quot;Apache Commons Logging&quot;</span><br><span class="line">    SLF4j：提供新的API，初衷是配合Logback使用，但同一时候兼容Log4j。</span><br><span class="line"></span><br><span class="line">日志系统：负责输出日志</span><br><span class="line">    Log4j：经典日志解决。内部把日志系统抽象封装成Logger 、appender 、pattern 等实现。</span><br><span class="line">        Appenders：也被称为Handlers。负责将日志事件记录到目标位置。在将日志事件输出之前，Appenders使用Layouts来对事件进行格式化处理。</span><br><span class="line">        Layouts：也被称为Formatters，它负责对日志事件中的数据进行转换和格式化。Layouts决定了数据在一条日志记录中的终于形式。</span><br><span class="line">        Loggers：Logger负责捕捉事件并将其发送给合适的Appender。</span><br><span class="line">    Log4j2：Log4j的2.0版本号。对Log4j进行了优化。比方支持參数API、支持异步appender、插件式架构等</span><br><span class="line">    Logback:</span><br><span class="line">    JUL(java.util.logging)：JDK提供的日志系统。</span><br></pre></td></tr></table></figure>

<h2 id="实现机制"><a href="#实现机制" class="headerlink" title="实现机制"></a>实现机制</h2><h3 id="Commons-Logging实现机制"><a href="#Commons-Logging实现机制" class="headerlink" title="Commons Logging实现机制"></a>Commons Logging实现机制</h3><p>Commons Logging是通过动态查找机制，在程序运行时，使用自己的ClassLoader寻找和载入本地具体的实现。详细策略可以查看commons-logging-*.jar包中的org.apache.commons.logging.impl.LogFactoryImpl.java文件。由于Osgi不同的插件使用独立的ClassLoader，Osgi的这种机制保证了插件互相独立, 其机制限制了Commons Logging在Osgi中的正常使用。</p>
<h3 id="Slf4j实现机制"><a href="#Slf4j实现机制" class="headerlink" title="Slf4j实现机制"></a>Slf4j实现机制</h3><p>Slf4j在编译期间，静态绑定本地的Log库，因此可以在Osgi中正常使用。它是通过查找类路径下org.slf4j.impl.StaticLoggerBinder，然后在StaticLoggerBinder中进行绑定。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.cnblogs.com/gavanwanggw/p/7305218.html" target="_blank" rel="noopener">https://www.cnblogs.com/gavanwanggw/p/7305218.html</a></p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lluzt.github.io/2019/08/28/Spring-AOP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="卢至彤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="卢至彤">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/28/Spring-AOP/" class="post-title-link" itemprop="url">Spring AOP</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-08-28 11:45:45 / 修改时间：17:02:07" itemprop="dateCreated datePublished" datetime="2019-08-28T11:45:45+08:00">2019-08-28</time>
            </span>
          
            

            
          

          <br/>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <h1 id="Spring-AOP"><a href="#Spring-AOP" class="headerlink" title="Spring AOP"></a>Spring AOP</h1><h2 id="AOP面向切面"><a href="#AOP面向切面" class="headerlink" title="AOP面向切面"></a>AOP面向切面</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">实现</span><br><span class="line">1.静态代理：接口</span><br><span class="line">2.JDK动态代理：反射机制</span><br><span class="line">3.CGLib(Code Generation Library):采用底层字节码技术，创建子类，织入横切逻辑。</span><br></pre></td></tr></table></figure>

<p>Spring </p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lluzt.github.io/2019/08/19/OpenCV-学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="卢至彤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="卢至彤">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/19/OpenCV-学习/" class="post-title-link" itemprop="url">OpenCV 学习</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-08-19 10:53:38 / 修改时间：10:53:40" itemprop="dateCreated datePublished" datetime="2019-08-19T10:53:38+08:00">2019-08-19</time>
            </span>
          
            

            
          

          <br/>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            
          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lluzt.github.io/2019/08/15/QRCode学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="卢至彤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="卢至彤">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/15/QRCode学习/" class="post-title-link" itemprop="url">QRCode学习</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-08-15 17:09:39" itemprop="dateCreated datePublished" datetime="2019-08-15T17:09:39+08:00">2019-08-15</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-08-19 10:46:16" itemprop="dateModified" datetime="2019-08-19T10:46:16+08:00">2019-08-19</time>
              </span>
            
          

          <br/>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <h1 id="QRCode-学习"><a href="#QRCode-学习" class="headerlink" title="QRCode   学习"></a>QRCode   学习</h1><p>二维条形码是用某种特定的几何图形按一定规律在平面（二维方向上）分布的黑白相间的图形记录数据符号信息的；在代码编制上巧妙地利用构成计算机内部逻辑基础的“0”、“1”比特流的概念，使用若干个与二进制相对应的几何形体来表示文字数值信息，通过图象输入设备或光电扫描设备自动识读以实现信息自动处理：它具有条码技术的一些共性：每种码制有其特定的字符集；每个字符占有一定的宽度；具有一定的校验功能等。同时还具有对不同行的信息自动识别功能、及处理图形旋转变化等特点。二维条形码能够在横向和纵向两个方位同时表达信息，因此能在很小的面积内表达大量的信息。</p>
<h2 id="QRCode-类型"><a href="#QRCode-类型" class="headerlink" title="QRCode 类型"></a>QRCode 类型</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">堆叠式二维条形码(2D Stacked Code)：堆叠式二维条形码是一种多层符号(Multi-Row Symbology)，通常是将一维条形码的高度截短再层叠起来表示资料。</span><br><span class="line">矩阵式二维条形码(2D Matrix Code)：矩阵式二条形码是一种由中心点到与中心点固定距离的多边形单元所组成的图形，用来表示资料及其它与符号相关功能。</span><br><span class="line">资料字元(Data Character)：用于表示特定资料的ASCII字元集的一个字母、数字或特殊符号等字元。</span><br><span class="line">符号字元(Symbol Character)：依条形码符号规则定义来表示资料的线条、空白组合形式。资料字元与符号字元间不一定是一对一的关系。一般情况下，每个符号字元分配一个唯一的值。</span><br><span class="line">代码集(Code Set)：代码集是指将资料字元转化为符号字元值的方法。</span><br><span class="line">字码(Codeword)：字码是指符号字元的值，为原始资料转换为符号字元过程的一个中间值，一种条形码的字码数决定了该类条形码所有符号字元的数量。</span><br><span class="line">字元自我检查(Character Self-Checking)：字元自我检查是指在一个符号字元中出现单一的印刷错误时，扫瞄器不会将该符号字元解码成其它符号字元的特性。</span><br><span class="line">错误纠正字元(Error Correction Character)：用于错误侦测和错误纠正的符号字元，这些字元是由其它符号字元计算而得，二维条形码一般有多个错误纠正字元用于错误侦测以及错误纠正。有些线性扫瞄器有一个错误纠正字元用于侦测错误。</span><br><span class="line">E错误纠正(Erasure Correction)：E错误是指在已知位置上因图像对比度不够，或有大污点等原因造成该位置符号字元无法辨识，因此又称为拒读错误。通过错误纠正字元对E错误的恢复称为E错误纠正。对于每个E错误的纠正仅需一个错误纠正字元。</span><br><span class="line">T错误纠正(Error Correction)：T错误是指因某种原因将一个符号字元识读为其它符号字元的错误，因此又称为替代错误。T错误的位置以及该位置的正确值都是未知的，因此对每个T错误的纠正需要两个错误纠正字元，一个用于找出位置，另一个用于纠正错误。</span><br><span class="line">错误侦测(Error Detection)：一般是保留一些错误纠正字元用于错误侦测，这些字元被称为侦测字元，用以侦测出符号中不超出错误纠正容量的错误数量，从而保证符号不被读错。此外，也可利用软体透过侦测无效错误纠正的计算结果提供错误侦测功能。若仅为E错误纠正则不提供错误侦测功能。</span><br></pre></td></tr></table></figure>

<h3 id="堆叠式-行排式"><a href="#堆叠式-行排式" class="headerlink" title="堆叠式/行排式"></a>堆叠式/行排式</h3><p>堆叠式/行排式二维条码又称堆积式二维条码或层排式二维条码），其编码原理是建立在一维条码基础之上，按需要堆积成二行或多行。它在编码设计、校验原理、识读方式等方面继承了一维条码的一些特点，识读设备与条码印刷与一维条码技术兼容。但由于行数的增加，需要对行进行判定，其译码算法与软件也不完全相同于一维条码。有代表性的行排式二维条码有：Code 16K、Code 49、PDF417等。</p>
<h3 id="矩阵式"><a href="#矩阵式" class="headerlink" title="矩阵式"></a>矩阵式</h3><p>矩阵式二维条码（又称棋盘式二维条码）它是在一个矩形空间通过黑、白像素在矩阵中的不同分布进行编码。在矩阵相应元素位置上，用点（方点、圆点或其他形状）的出现表示二进制“1”，点的不出现表示二进制的“0”，点的排列组合确定了矩阵式二维条码所代表的意义。矩阵式二维条码是建立在计算机图像处理技术、组合编码原理等基础上的一种新型图形符号自动识读处理码制。具有代表性的矩阵式二维条码有：Code One、Maxi Code、QR Code、 Data Matrix等。</p>
<h2 id="QR-Code码"><a href="#QR-Code码" class="headerlink" title="QR Code码"></a>QR Code码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1、符号规格从版本1（21×21模块）到版本40（177×177 模块），每提高一个版本，每边增加4个模块。</span><br><span class="line">2、数据类型与容量（参照最大规格符号版本40-L级）：</span><br><span class="line">数字数据：7,089个字符</span><br><span class="line">字母数据: 4,296个字符</span><br><span class="line">8位字节数据: 2,953个字符</span><br><span class="line">汉字数据：1,817个字符</span><br><span class="line">3、数据表示方法：</span><br><span class="line">深色模块表示二进制&quot;1&quot;，浅色模块表示二进制&quot;0&quot;。</span><br><span class="line">4、纠错能力：</span><br><span class="line">L级：约可纠错7%的数据码字</span><br><span class="line">M级：约可纠错15%的数据码字</span><br><span class="line">Q级：约可纠错25%的数据码字</span><br><span class="line">H级：约可纠错30%的数据码字</span><br><span class="line">5、结构链接（可选）</span><br><span class="line">可用1-16个QR Code码符号表示一组信息。每一符号表示100个字符的信息。</span><br></pre></td></tr></table></figure>

<p><img src="images/qrcode.png" alt></p>
<h3 id="QR-Code码生成"><a href="#QR-Code码生成" class="headerlink" title="QR Code码生成"></a>QR Code码生成</h3><h4 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h4><p>确定编码的字符类型，按相应的字符集转换成符号字符； 选择纠错等级，在规格一定的条件下，纠错等级越高其真实数据的容量越小。</p>
<h4 id="数据编码"><a href="#数据编码" class="headerlink" title="数据编码"></a>数据编码</h4><p>将数据字符转换为位流，每8位一个码字，整体构成一个数据的码字序列。其实知道这个数据码字序列就知道了二维码的数据内容。<br>以数据01234567编码为例</p>
<p>1）分组：012 345 67</p>
<p>2）转成二进制：012→0000001100      345→0101011001     67 →1000011</p>
<p>3）转成序列：0000001100 0101011001 1000011</p>
<p>4）字符数 转成二进制：8→0000001000</p>
<p>5）加入模式指示符 0001：0001 0000001000 0000001100 0101011001 1000011</p>
<h4 id="纠错编码"><a href="#纠错编码" class="headerlink" title="纠错编码"></a>纠错编码</h4><p>按需要将上面的码字序列分块，并根据纠错等级和分块的码字，产生纠错码字，并把纠错码字加入到数据码字序列后面，成为一个新的序列。在二维码规格和纠错等级确定的情况下，其实它所能容纳的码字总数和纠错码字数也就确定了，比如：版本10，纠错等级是H时，总共能容纳346个码字，其中224个纠错码字。就是说二维码区域中大约1/3的码字是冗余的。对于这224个纠错码字，它能够纠正112个替代错误（如黑白颠倒）或者224个句读错误（无法读到或者无法译码），这样纠错容量为：112/346=32.4%</p>
<h4 id="构造最终数据信息"><a href="#构造最终数据信息" class="headerlink" title="构造最终数据信息"></a>构造最终数据信息</h4><p>在规格确定的条件下，将上面产生的序列按次序放如分块中按规定把数据分块，然后对每一块进行计算，得出相应的纠错码字区块，把纠错码字区块 按顺序构成一个序列，添加到原先的数据码字序列后面。如：D1, D12, D23, D35, D2, D13, D24, D36, … D11, D22, D33, D45, D34, D46, E1, E23,E45, E67, E2, E24, E46, E68，…</p>
<h4 id="构造矩阵"><a href="#构造矩阵" class="headerlink" title="构造矩阵"></a>构造矩阵</h4><p><img src="images/qrcode2.png" alt></p>
<ul>
<li><p>位置探测图形、位置探测图形分隔符、定位图形：用于对二维码的定位，对每个QR码来说，位置都是固定存在的，只是大小规格会有所差异；</p>
</li>
<li><p>校正图形：规格确定，校正图形的数量和位置也就确定了；</p>
</li>
<li><p>格式信息：表示改二维码的纠错级别，分为L、M、Q、H；</p>
</li>
<li><p>版本信息：即二维码的规格，QR码符号共有40种规格的矩阵（一般为黑白色），从21×21（版本1），到177×177（版本40），每一版本符号比前一版本 每边增加4个模块。</p>
</li>
<li><p>数据和纠错码字：实际保存的二维码信息，和纠错码字（用于修正二维码损坏带来的错误）。</p>
</li>
</ul>
<p>将探测图形、分隔符、定位图形、校正图形和码字模块放入矩阵中，并把上面的完整序列填充到相应规格的二维码矩阵的区域中。</p>
<p><img src="images/qrcode3.png" alt></p>
<h4 id="掩膜"><a href="#掩膜" class="headerlink" title="掩膜"></a>掩膜</h4><p>将掩摸图形用于符号的编码区域，使得二维码图形中的深色和浅色（黑色和白色）区域能够比率最优的分布。</p>
<h4 id="格式和版本信息"><a href="#格式和版本信息" class="headerlink" title="格式和版本信息"></a>格式和版本信息</h4><p>生成格式和版本信息放入相应区域内。版本7-40都包含了版本信息，没有版本信息的全为0。二维码上两个位置包含了版本信息，它们是冗余的。版本信息共18位，6X3的矩阵，其中6位时数据为，如版本号8，数据位的信息时 001000，后面的12位是纠错位。</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://cli.im/" target="_blank" rel="noopener">https://cli.im/</a><br><a href="https://www.douban.com/group/topic/9147222/" target="_blank" rel="noopener">https://www.douban.com/group/topic/9147222/</a></p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lluzt.github.io/2019/08/01/Mysql-存储引擎（三）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="卢至彤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="卢至彤">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/01/Mysql-存储引擎（三）/" class="post-title-link" itemprop="url">Mysql-存储引擎</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-08-01 17:18:23 / 修改时间：17:26:10" itemprop="dateCreated datePublished" datetime="2019-08-01T17:18:23+08:00">2019-08-01</time>
            </span>
          
            

            
          

          <br/>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <h1 id="Mysql存储引擎"><a href="#Mysql存储引擎" class="headerlink" title="Mysql存储引擎"></a>Mysql存储引擎</h1><p>MySQL插件式存储引擎体系结构在存储级别上提供了一致和简单的应用模型和API，应用程序编程人员和DBA可不再考虑所有的底层实施细节。</p>
<p><img src="images/mysql-pluggable-storage.png" alt></p>
<h2 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h2><p>从技术角度上看，在存储引擎的一些关键差别包括：</p>
<ul>
<li>并发性：某些应用程序比其他应用程序具有很多的颗粒级锁定要求（如行级锁定）。选择正确的锁定策略能够减少开销，并有助于整体性能的提升。它还包括对多种能力的支持，如多版本并发性控制或“快照”读取等。</li>
<li>事务支持：并非所有的应用程序都需要事务，但对的确需要事务的应用程序来说，有着定义良好的需求，如ACID兼容等。</li>
<li>引用完整性：通过DDDL定义的 外键，服务器需要强制保持关联数据库的引用完整性。</li>
<li>物理存储：它包括各种各样的事项，从表和索引的总的页大小，到存储数据所需的格式，到物理磁盘。</li>
<li>索引支持：不同的应用程序倾向于采用不同的索引策略，每种存储引擎通常有自己的编制索引方法，但某些索引方法（如B-tree索引）对几乎所有的存储引擎来说是共同的。</li>
<li>内存高速缓冲：与其他应用程序相比，不同的应用程序对某些内存高速缓冲策略的响应更好，因此，尽管某些内存高速缓冲对所有存储引擎来说是共同的（如用于用户连接的高速缓冲，MySQL的高速查询高速缓冲等），其他高速缓冲策略仅当使用特殊的存储引擎时才唯一定义。</li>
<li>性能帮助：包括针对并行操作的多I/O线程，线程并发性，数据库检查点，成批插入处理等。</li>
<li>其他目标特性：可能包括对地理空间操作的支持，对特定数据处理操作的安全限制等。</li>
</ul>
<p><img src="images/pluggable-storage-choosing.png" alt></p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-reference" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lluzt.github.io/2019/07/31/参考/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="卢至彤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="卢至彤">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/31/参考/" class="post-title-link" itemprop="url">参考</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-31 18:09:06" itemprop="dateCreated datePublished" datetime="2019-07-31T18:09:06+08:00">2019-07-31</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-08-01 10:52:12" itemprop="dateModified" datetime="2019-08-01T10:52:12+08:00">2019-08-01</time>
              </span>
            
          

          <br/>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <ul>
<li><a href="https://liuzhengyang.github.io/" target="_blank" rel="noopener">https://liuzhengyang.github.io/</a></li>
</ul>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lluzt.github.io/2019/07/31/Mysql-概述/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="卢至彤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="卢至彤">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/31/Mysql-概述/" class="post-title-link" itemprop="url">Mysql 概述</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-31 16:34:14" itemprop="dateCreated datePublished" datetime="2019-07-31T16:34:14+08:00">2019-07-31</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-08-01 17:33:46" itemprop="dateModified" datetime="2019-08-01T17:33:46+08:00">2019-08-01</time>
              </span>
            
          

          <br/>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <h1 id="Mysql-概述"><a href="#Mysql-概述" class="headerlink" title="Mysql 概述"></a>Mysql 概述</h1><p>MySQL从概念上可以分为四层，顶层是接入层，不同语言的客户端通过mysql的协议与mysql服务器进行连接通信，接入层进行权限验证、连接池管理、线程管理等。下面是mysql服务层，包括sql解析器、sql优化器、数据缓冲、缓存等。再下面是mysql中的存储引擎层，mysql中存储引擎是基于表的。最后是系统文件层，保存数据、索引、日志等。<br><img src="images/mysql.jpg" alt></p>
<h2 id="Mysql-特性"><a href="#Mysql-特性" class="headerlink" title="Mysql 特性"></a>Mysql 特性</h2><ul>
<li>使用C和C++编写</li>
<li>提供了事务性和非事务性存储引擎</li>
<li>使用了极快的“B树”磁盘表（MyISAM）和索引压缩</li>
<li>采用核心线程的完全多线程 如果有多个CPU，它能方便地使用这些CPU</li>
<li>极快的基于线程的内存分配系统。</li>
<li>通过使用优化的“单扫描多连接”，能实现极快的连接。</li>
<li>存储器中的哈希表用作临时表。</li>
<li>可伸缩性和限制<br>  1.处理大型数据库： 我们使用了MySQL服务器和含5千万条记录的数据库。我们还听说，有些用户将MySQL用于含60000个表和约50亿行的数据库。<br>  2.每个表可支持高达64条索引（在MySQL 4.1.2之前为32条）。每条索引可由1～16个列或列元素组成。最大索引宽度为1000字节（在MySQL 4.1.2之前为500）。索引可使用具备CHAR、VARCHAR、BLOB或TEXT列类型的列前缀。</li>
</ul>
<h2 id="Mysql-程序"><a href="#Mysql-程序" class="headerlink" title="Mysql 程序"></a>Mysql 程序</h2><h3 id="MYSQL服务器和服务器启动脚本："><a href="#MYSQL服务器和服务器启动脚本：" class="headerlink" title="MYSQL服务器和服务器启动脚本："></a>MYSQL服务器和服务器启动脚本：</h3><ul>
<li><p>mysqld是MySQL服务器</p>
</li>
<li><p>mysqld_safe、mysql.server和mysqld_multi是服务器启动脚本</p>
</li>
<li><p>mysql_install_db初始化数据目录和初始数据库</p>
<h3 id="访问服务器的客户程序："><a href="#访问服务器的客户程序：" class="headerlink" title="访问服务器的客户程序："></a>访问服务器的客户程序：</h3></li>
<li><p>mysql是一个命令行客户程序，用于交互式或以批处理模式执行SQL语句。</p>
</li>
<li><p>mysqladmin是用于管理功能的客户程序。</p>
</li>
<li><p>mysqlcheck执行表维护操作。</p>
</li>
<li><p>mysqldump和mysqlhotcopy负责数据库备份。</p>
</li>
<li><p>mysqlimport导入数据文件。 </p>
</li>
<li><p>mysqlshow显示信息数据库和表的相关信息。</p>
<h3 id="独立于服务器操作的工具程序："><a href="#独立于服务器操作的工具程序：" class="headerlink" title="独立于服务器操作的工具程序："></a>独立于服务器操作的工具程序：</h3></li>
<li><p>myisamchk执行表维护操作。</p>
</li>
<li><p>myisampack产生压缩、只读的表。</p>
</li>
<li><p>mysqlbinlog是处理二进制日志文件的实用工具。</p>
</li>
<li><p>perror显示错误代码的含义。</p>
</li>
</ul>
<h3 id="Mysql复制"><a href="#Mysql复制" class="headerlink" title="Mysql复制"></a>Mysql复制</h3><p>MySQL支持单向、异步复制，复制过程中一个服务器充当主服务器，而一个或多个其它服务器充当从服务器。</p>
<h4 id="二进制日志"><a href="#二进制日志" class="headerlink" title="二进制日志"></a>二进制日志</h4><p>每个从服务器从主服务器接收主服务器已经记录到其二进制日志的保存的更新，以便从服务器可以对其数据拷贝执行相同的更新。<br>将主服务器的数据拷贝到从服务器的一个途径是使用LOAD DATA FROM MASTER语句。请注意LOAD DATA FROM MASTER目前只在所有表使用MyISAM存储引擎的主服务器上工作。并且，该语句将获得全局读锁定，因此当表正复制到从服务器上时，不可能在主服务器上进行更新。当我们执行表的无锁热备份时，则不再需要全局读锁定。</p>
<p>MySQL使用3个线程来执行复制功能(其中1个在主服务器上，另两个在从服务器上。当发出START SLAVE时，从服务器创建一个I/O线程，以连接主服务器并让它发送记录在其二进制日志中的语句。主服务器创建一个线程将二进制日志中的内容发送到从服务器。该线程可以识别为主服务器上SHOW PROCESSLIST的输出中的Binlog Dump线程。从服务器I/O线程读取主服务器Binlog Dump线程发送的内容并将该数据拷贝到从服务器数据目录中的本地文件中，即中继日志。第3个线程是SQL线程，是从服务器创建用于读取中继日志并执行日志中包含的更新。</p>
<h4 id="复制操作"><a href="#复制操作" class="headerlink" title="复制操作"></a>复制操作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; GRANT REPLICATION SLAVE ON *.* TO &apos;repl&apos;@&apos;%.mydomain.com&apos; IDENTIFIED BY &apos;slavepass&apos;;</span><br><span class="line">&gt; FLUSH TABLES WITH READ LOCK;</span><br><span class="line">&gt; SHOW MASTER STATUS;</span><br><span class="line">$ tar -cvf /tmp/mysql-snapshot.tar .#使用归档程序对主服务器上的数据目录中的数据库进行二进制备份</span><br><span class="line">&gt; UNLOCK TABLES;</span><br><span class="line"></span><br><span class="line">$ mysqldump --master-data</span><br><span class="line">&gt; mysqld --skip-slave-start</span><br><span class="line">&gt; mysql -u root -p &lt; dump_file.sql</span><br><span class="line">&gt; START SLAVE；</span><br></pre></td></tr></table></figure>

<p>my.cnf</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server-id=1</span><br></pre></td></tr></table></figure>

<h3 id="其他概念"><a href="#其他概念" class="headerlink" title="其他概念"></a>其他概念</h3><ul>
<li>mysql簇<br><img src="images/cluster-components-1.png" alt></li>
<li>分区<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE employees (</span><br><span class="line">    id INT NOT NULL,</span><br><span class="line">    fname VARCHAR(30),</span><br><span class="line">    lname VARCHAR(30),</span><br><span class="line">    hired DATE NOT NULL DEFAULT &apos;1970-01-01&apos;,</span><br><span class="line">    separated DATE NOT NULL DEFAULT &apos;9999-12-31&apos;,</span><br><span class="line">    job_code INT NOT NULL,</span><br><span class="line">    store_id INT NOT NULL</span><br><span class="line">)</span><br><span class="line">PARTITION BY RANGE (store_id) (</span><br><span class="line">    PARTITION p0 VALUES LESS THAN (6),</span><br><span class="line">    PARTITION p1 VALUES LESS THAN (11),</span><br><span class="line">    PARTITION p2 VALUES LESS THAN (16),</span><br><span class="line">    PARTITION p3 VALUES LESS THAN (21)</span><br><span class="line">)；</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.mysqlzh.com/" target="_blank" rel="noopener">https://www.mysqlzh.com/</a></p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lluzt.github.io/2019/07/31/Mysql-优化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="卢至彤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="卢至彤">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/31/Mysql-优化/" class="post-title-link" itemprop="url">Mysql 优化（三）</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-31 16:28:52" itemprop="dateCreated datePublished" datetime="2019-07-31T16:28:52+08:00">2019-07-31</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-08-30 16:55:40" itemprop="dateModified" datetime="2019-08-30T16:55:40+08:00">2019-08-30</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a></span>

                
                
              
            </span>
          

          <br/>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <h2 id="mysql优化方向概述"><a href="#mysql优化方向概述" class="headerlink" title="mysql优化方向概述"></a>mysql优化方向概述</h2><p>mysql在开发中的优化主要有4个方向：<br>    1. 存储层：数据表存储引擎选取、字段类型选取、查询缓存、3范式、数据碎片维护<br>    2. 设计层：索引、分区、分表<br>    3. 架构层：分布式部署(集群)(主从复制、读写分离)<br>    4. sql语句层：锁的使用、慢查询的定位、limit分页优化<br>    5. 其他</p>
<h3 id="存储引擎选择"><a href="#存储引擎选择" class="headerlink" title="存储引擎选择"></a>存储引擎选择</h3><p>三种存储引擎特点</p>
<ul>
<li>Myisam：表锁，全文索引</li>
<li>Innodb：行(记录)锁，事务(回滚)，外键</li>
<li>Memory：内存存储引擎，速度快、数据容易丢失</li>
</ul>
<h4 id="Innodb"><a href="#Innodb" class="headerlink" title="Innodb"></a>Innodb</h4><p>(1) 存储格式</p>
<p>表结构存储于* .frm文件中。<br>默认所有表的数据/索引存储在同一个表空间文件中。<br>可以通过配置将不同表的数据/索引单独存储在*.ibd中，方便管理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create table t1(id int, name varchar(32))engine innodb charset utf8;</span><br><span class="line">mysql&gt; show variables like &apos;innodb_file_per_table%&apos;;</span><br><span class="line">mysql&gt; set global innodb_file_per_table=1;</span><br></pre></td></tr></table></figure>


<p>(2) 存储顺序: 主键顺序</p>
<p>数据按照主键顺序存储，写入顺序与存储顺序不同，因此速度比Myisam稍慢。</p>
<p>(3) 并发处理</p>
<p>擅长并发处理，支持行级锁和表级锁。</p>
<h4 id="MyISAM"><a href="#MyISAM" class="headerlink" title="MyISAM"></a>MyISAM</h4><p>(1) 存储格式<br>mysql5.5以下默认存储引擎。<br>结构、数据、索引分别存储于frm、MYD、MYI文件中，支持直接通过文件复制粘贴进行备份还原。<br>(2) 存储顺序: 插入顺序<br>写入速度快<br>(3) 并发处理<br>不如innodb，只支持表级锁<br>(4) 压缩性<br>对于不频繁发生变化的数据，可以进行压缩，压缩后只读，写操作需要先解压</p>
<h4 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h4><p>内存存储引擎，速度快、数据容易丢失，可以用作缓存。</p>
<h4 id="innodb-amp-myisam-的适用场"><a href="#innodb-amp-myisam-的适用场" class="headerlink" title="innodb &amp; myisam 的适用场"></a>innodb &amp; myisam 的适用场</h4><p>myisam：写入快，适合写入、读取操作多的系统，如微博。表锁，全文索引。</p>
<p>innodb：适合业务逻辑强、修改操作多的系统，如商城、办公系统。行(记录)锁，事务(回滚)，外键。</p>
<h3 id="查询缓存"><a href="#查询缓存" class="headerlink" title="查询缓存"></a>查询缓存</h3><p>mysql服务器提供的用于缓存select语句结果的一种内部内存缓存系统。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &apos;query_cache%&apos;;</span><br><span class="line"># query_cache_size: 缓存空间大小</span><br><span class="line"># query_cache_type: 是否开启缓存</span><br><span class="line"># 在 my.ini 中开启缓存，设置缓存空间为128M</span><br><span class="line">query_cache_type=1</span><br><span class="line">query_cache_size=134217728</span><br><span class="line"># 重启mysql</span><br></pre></td></tr></table></figure>

<h4 id="缓存失效"><a href="#缓存失效" class="headerlink" title="缓存失效"></a>缓存失效</h4><p>数据表的数据发生变化(数据修改)或结构改变(字段增删)，则会清空全部的缓存数据，即缓存失效。<br>sql语句中有变化表达式(时间、随机数等)，则不会使用缓存。<br>生成缓存的sql语句对”空格”、”大小写”敏感，相同结果的sql语句，由于空格、大小写问题就会分别生成多个缓存     </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select name, now() from t2 where id=1234; # 不使用缓存</span><br><span class="line">mysql&gt; select * from t2 order by rand() limit 5; # 不使用缓存</span><br><span class="line"></span><br><span class="line">mysql&gt; select sql_no_cache * from t2 where id=1234; #禁用缓存</span><br><span class="line"> </span><br><span class="line">mysql&gt; show status like &apos;Qcache%&apos;;#查看缓存空间的使用</span><br></pre></td></tr></table></figure>

<h3 id="范式"><a href="#范式" class="headerlink" title="范式"></a>范式</h3><p>范式主要分为四类范式，在开发过程中没有特殊情况数据表尽量要设计为第三范式。</p>
<p>第一范式：<br>(1) 表属性(列)具有原子性(不可分割)<br>(2) 表属性(列)不能重复</p>
<p>第二范式：<br>表中不能存在完全相同的两条记录，通常通过设置主键来实现。</p>
<p>第三范式：<br>表中不能存在冗余数据，列数据不能通过推导得到。</p>
<p>反三范式：<br>有时出于性能考虑，有意违反三范式，适度冗余，提高查询效率，例如存储浏览量。</p>
<h3 id="数据碎片与维护"><a href="#数据碎片与维护" class="headerlink" title="数据碎片与维护"></a>数据碎片与维护</h3><p>长期数据操作过程中，索引和数据文件产生空洞碎片，会拖慢执行效率，需要修复，修复可以把数据文件重新整理，使之对齐。由于修复十分消耗资源，如果表的update、delete操作频繁，可以按周月修复。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 方式1:</span><br><span class="line">mysql&gt; alter table engine innodb;</span><br><span class="line"># 方式2:</span><br><span class="line">mysql&gt; optimize table &lt;表名&gt;;</span><br></pre></td></tr></table></figure>






<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://csxiaoyao.cn/index.html#/" target="_blank" rel="noopener">https://csxiaoyao.cn/</a></p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lluzt.github.io/2019/07/31/Mysql-MVCC（二）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="卢至彤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="卢至彤">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/31/Mysql-MVCC（二）/" class="post-title-link" itemprop="url">Mysql MVCC（二）</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-31 16:28:28" itemprop="dateCreated datePublished" datetime="2019-07-31T16:28:28+08:00">2019-07-31</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-08-01 11:16:24" itemprop="dateModified" datetime="2019-08-01T11:16:24+08:00">2019-08-01</time>
              </span>
            
          

          <br/>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <h1 id="Mysql-MVCC"><a href="#Mysql-MVCC" class="headerlink" title="Mysql MVCC"></a>Mysql MVCC</h1><p>MVCC是Multi Version Concurrency Control的简称，代表多版本并发控制。实现读不阻塞写，写不阻塞读</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">数据库事务的ACID特性:Atomicity(原子性), Consistency(一致性), Isolation(隔离性), Durability(持久性) </span><br><span class="line">* 原子性表示一个事务的操作结果要么全部执行要么全部不执行。</span><br><span class="line">* 一致性表示事务总是从一个一致的状态转换到另一个一致的状态。</span><br><span class="line">* 隔离性表示一个事务的修改结果在什么时间能够被其他事务看到，SQL1992规范中对隔离性定义了不同的隔离级别：</span><br><span class="line">    1.读未提交(READ UNCOMMITED)：事务能够看到其他事务没有提及的修改，可能出现dirty read。</span><br><span class="line">    2.读已提交(READ COMMITTED)：事务能够看到其他事务提交后的修改，这时会出现一个事务内两次读取数据可能因为其他事务提交的修改导致不一致的情况，称为不可重复读。 </span><br><span class="line">    3.可重复读(REPEATABLE READ)：在两次读取时读取到的数据的状态是一致的。</span><br><span class="line">    4.序列化(SERIALIZABLE)：可重复读中可能出现第二次读读到第一次没有读到的数据，也就是被其他事务插入的数据，这种情况称为幻读phantom read, 序列化级别中不能出现幻读。</span><br><span class="line">隔离级别依次增强，并发能力依次减弱。</span><br><span class="line"></span><br><span class="line">和Java中的多线程问题相同，数据库通常使用锁来实现隔离性。</span><br><span class="line">    1.读写锁</span><br><span class="line">    2.读写锁冲突解决：不同的事务session会看到自己特定版本的数据，即快照。</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* binlog:常用来进行数据恢复、数据库复制，常见的mysql主从架构，就是采用slave同步master的binlog实现的, 另外通过解析binlog能够实现mysql到其他数据源（如ElasticSearch)的数据复制。</span><br><span class="line">* redo log:记录了数据操作在物理层面的修改，mysql中使用了大量缓存，缓存存在于内存中，修改操作时会直接修改内存，而不是立刻修改磁盘，当内存和磁盘的数据不一致时，称内存中的数据为脏页(dirty page)。为了保证数据的安全性，事务进行中时会不断的产生redo log，在事务提交时进行一次flush操作，保存到磁盘中, redo log是按照顺序写入的，磁盘的顺序读写的速度远大于随机读写。当数据库或主机失效重启时，会根据redo log进行数据的恢复。</span><br><span class="line">* undo Log: 通过undo log可以实现事务回滚，并且可以根据undo log回溯到某个特定的版本的数据，实现MVCC。在Innodb中存在purge线程，它会查询那些比现在最老的活动事务还早的undo log，并删除它们，从而保证undo log文件不至于无限增长。</span><br></pre></td></tr></table></figure>

<p><img src="images/undolog.jpg" alt></p>
<p>InnoDB表会有三个隐藏字段</p>
<ul>
<li>6字节的DB_ROW_ID</li>
<li>6字节的DB_TX_ID</li>
<li>7字节的DB_ROLL_PTR </li>
</ul>
<p>在每个事务开始的时候，会将当前系统中的所有的活跃事务拷贝到一个列表中 (read view)，根据read view最早一个事务ID和最晚的一个事务ID来做比较的，这样就能确保在当前事务之前没有提交的所有事务的变更以及后续新启动的事务的变更，在当前事务中都是看不到的,本事务的变更可见。</p>
<p>###参考<br><a href="https://liuzhengyang.github.io/2017/04/18/innodb-mvcc/" target="_blank" rel="noopener">https://liuzhengyang.github.io/2017/04/18/innodb-mvcc/</a></p>

          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
      

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lluzt.github.io/2019/07/31/Mysql-索引（一）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="卢至彤">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="卢至彤">
    </span>
      <header class="post-header">

        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/31/Mysql-索引（一）/" class="post-title-link" itemprop="url">Mysql 索引（一）</a>
              
            
          </h1>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-31 16:28:11" itemprop="dateCreated datePublished" datetime="2019-07-31T16:28:11+08:00">2019-07-31</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-08-30 17:07:11" itemprop="dateModified" datetime="2019-08-30T17:07:11+08:00">2019-08-30</time>
              </span>
            
          

          <br/>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
            <h1 id="Mysql索引"><a href="#Mysql索引" class="headerlink" title="Mysql索引"></a>Mysql索引</h1>
          
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
    </footer>
  </div>
  
  
  
  </article>

    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">

          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">卢至彤</p>
  <div class="site-description motion-element" itemprop="description"></div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">12</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        
        
          
        
          
        
          
        
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>



        </div>
      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">卢至彤</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.2.0</div>

        








        
      </div>
    </footer>
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
      </div>

    

  </div>

  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  <script src="/js/utils.js?v=7.2.0"></script>
  <script src="/js/motion.js?v=7.2.0"></script>

  
  <script src="/js/schemes/muse.js?v=7.2.0"></script>



  

  <script src="/js/next-boot.js?v=7.2.0"></script>

  

  

  


  




































</body>
</html>
